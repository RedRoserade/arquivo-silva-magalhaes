@model DocumentEditViewModel

@{
    ViewBag.Title = DocumentStrings.CreateTitleFormat;
    Layout = "~/Areas/BackOffice/Views/Shared/_EditPageLayout.cshtml";
}

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

        @Html.PartialFor(model => model.Document, "_DocumentMainFields")

        @Html.Partial("_DocumentDropDownLists")

        @Html.PartialFor(model => model.Document.Translations[0], "_DocumentTranslateableFields")

        @Html.Partial("_SubmitBackPartial", UiStrings.Create)
    </div>
}

@section AdditionalScripts {
    <script async>
        (function () {
            $('[data-afsm-suggest=true]').click(function ($event) {
                var $e = $($event.target);

                var src = $('#' + $e.data('afsm-src'));
                var url = $e.data('afsm-url');
                var forElement = $('#' + $e.data('afsm-for'));

                if (src.val() == '') {
                    src.focus();
                    alert('Escolha primeiro uma coleção.');
                } else {
                    $.ajax(url.replace('xx', src.val()))
                     .done(function (data) {
                         forElement.val(data);
                     })
                     .fail(function (err) {
                         console.error(err);
                         alert('Erro!!');
                     });
                }
            });
        }());
    </script>
}
